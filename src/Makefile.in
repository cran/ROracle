#
# Input variables:
#   $(R_HOME_DIR), and $(ORACLE_HOME)
#

RHOME = @R_HOME_DIR@

SRC   = RS-DBI.h RS-DBI.c RS-Oracle.h RS-Oracle.pc S4R.h
OBJ   = RS-DBI.o RS-Oracle.o

##
## The Oracle ProC/C++ precompiler and options we need
##
PROC=proc
CODE=ANSI_C
MODE=ORACLE
PARSE=NONE
LINES=false
PREFETCH=@PREFETCH@
#PREFETCH=0    ## uncomment when compiling w. Oracle 8i (up to 8.1.7.2)

ROracle.so:  $(OBJ) 
	R CMD SHLIB -o ROracle.so RS-DBI.o RS-Oracle.o

RS-DBI.o: RS-DBI.h RS-DBI.c
	R CMD COMPILE RS-DBI.c

RS-Oracle.o: RS-Oracle.c
	R CMD COMPILE RS-Oracle.c

RS-Oracle.c: RS-Oracle.h RS-Oracle.pc 
	$(PROC) CODE=$(CODE) MODE=$(MODE) INCLUDE=$(RHOME)/include \
                PARSE=$(PARSE) LINES=$(LINES) PREFETCH=$(PREFETCH) RS-Oracle.pc
clean:
	rm -f $(OBJ) RS-Oracle.c
